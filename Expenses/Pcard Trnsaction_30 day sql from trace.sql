 
select  /*+ inline */  T4534805.C3289490 as c3,
     T4534805.C351787014 as c4,
     T4534805.C284646344 as c5,
     T4534805.C365682431 as c6,
     T4534805.C329886195 as c7,
     T4534805.C494510518 as c9,
     T4534805.C467828397 as c10,
     T4534805.C534028813 as c11,
     T4534805.C189421211 as c12,
     T4534805.C123805641 as c13
from 
     (SELECT V156107575.MERCHANT_NAME1 AS C3289490,         V156107575.TRANSACTION_DATE AS C351787014,         V486837407.FULL_NAME640 AS C284646344,         V486837407.PERSON_NUMBER AS C365682431,         V188742348.EXPENSE_REPORT_NUM AS C329886195,         V156107575.TRANSACTION_AMOUNT AS C494510518,         V156107575.MERCHANT_ADDRESS1 AS C467828397,         V156107575.MERCHANT_CITY AS C534028813,         V156107575.MERCHANT_PROVINCE_STATE AS C189421211,         V156107575.MERCHANT_COUNTRY AS C123805641,         V188742348.EXPENSE_STATUS_CODE AS C131628674,         V156107575.CREDIT_CARD_TRXN_ID AS PKA_CreditCardTrxCreditCardTr0,         V188742348.EXPENSE_REPORT_ID1 AS PKA_ExpHdrExpenseReportId0,         V486837407.PERSON_ID415 AS PKA_PersonDetailsPEOPersonId0,         V486837407.EFFECTIVE_START_DATE424 AS PKA_PersonDetailsPEOEffective0,         V486837407.EFFECTIVE_END_DATE433 AS PKA_PersonDetailsPEOEffective1,         V486837407.PERSON_NAME_ID564 AS PKA_PersonNamePEOPersonNameId0,         V486837407.EFFECTIVE_START_DATE574 AS PKA_PersonNamePEOEffectiveSta0,         V486837407.EFFECTIVE_END_DATE584 AS PKA_PersonNamePEOEffectiveEnd0 FROM (SELECT CreditCardTrx.CREDIT_CARD_TRXN_ID,         CreditCardTrx.MERCHANT_ADDRESS1,         CreditCardTrx.MERCHANT_CITY,         CreditCardTrx.MERCHANT_COUNTRY,         CreditCardTrx.MERCHANT_NAME1,         CreditCardTrx.MERCHANT_PROVINCE_STATE,         CreditCardTrx.TRANSACTION_AMOUNT,         CreditCardTrx.TRANSACTION_DATE,         ExpensePEO.ASSIGNMENT_ID,         ExpensePEO.PERSON_ID,         ExpHdr.EXPENSE_REPORT_ID FROM EXM_CREDIT_CARD_TRXNS CreditCardTrx, EXM_EXPENSES ExpensePEO, EXM_EXPENSE_REPORTS ExpHdr WHERE CreditCardTrx.CREDIT_CARD_TRXN_ID = ExpensePEO.CREDIT_CARD_TRXN_ID(+) AND (-1) = (nvl(ITEMIZATION_PARENT_EXPENSE_ID, -1)) AND ExpensePEO.EXPENSE_REPORT_ID = ExpHdr.EXPENSE_REPORT_ID(+)) V156107575, (SELECT Exp.EXPENSE_ID,         ExpHdr.EXPENSE_REPORT_ID AS EXPENSE_REPORT_ID1,         ExpHdr.EXPENSE_REPORT_NUM,         ExpHdr.EXPENSE_STATUS_CODE,         ExpCreditCardTrx.CREDIT_CARD_TRXN_ID AS CREDIT_CARD_TRXN_ID1 FROM EXM_EXPENSES Exp, EXM_EXPENSE_REPORTS ExpHdr, EXM_CREDIT_CARD_TRXNS ExpCreditCardTrx WHERE (Exp.EXPENSE_REPORT_ID = ExpHdr.EXPENSE_REPORT_ID(+) AND Exp.CREDIT_CARD_TRXN_ID = ExpCreditCardTrx.CREDIT_CARD_TRXN_ID(+)) AND ( ( ( ((NVL(Exp.ITEMIZATION_PARENT_EXPENSE_ID, 1)) <> -1 ) ) )  AND ((1=1 OR HRC_SESSION_UTIL.get_user_personid = Exp.PERSON_ID OR exists (select person_id from per_manager_hrchy_dn where manager_id = HRC_SESSION_UTIL.get_user_personid and person_id = Exp.PERSON_ID))) )) V188742348, (SELECT /*+ NO_PUSH_PRED */ PersonPEO.PERSON_ID AS PERSON_ID271,         PersonDetailsPEO.PERSON_ID AS PERSON_ID415,         PersonDetailsPEO.EFFECTIVE_START_DATE AS EFFECTIVE_START_DATE424,         PersonDetailsPEO.EFFECTIVE_END_DATE AS EFFECTIVE_END_DATE433,         PersonDetailsPEO.PERSON_NUMBER,         PersonNamePEO.PERSON_NAME_ID AS PERSON_NAME_ID564,         PersonNamePEO.EFFECTIVE_START_DATE AS EFFECTIVE_START_DATE574,         PersonNamePEO.EFFECTIVE_END_DATE AS EFFECTIVE_END_DATE584,         PersonNamePEO.FULL_NAME AS FULL_NAME640,         AssignmentPEO.ASSIGNMENT_ID AS ASSIGNMENT_ID776,         AssignmentPEO.DEFAULT_CODE_COMB_ID FROM PER_PERSONS PersonPEO, PER_ALL_PEOPLE_F PersonDetailsPEO, PER_PERSON_NAMES_F_V PersonNamePEO, PER_ALL_ASSIGNMENTS_M AssignmentPEO WHERE (PersonPEO.PERSON_ID = PersonDetailsPEO.PERSON_ID AND PersonPEO.PERSON_ID = PersonNamePEO.PERSON_ID AND PersonPEO.PERSON_ID = AssignmentPEO.PERSON_ID AND ( DATE'2024-04-16'  BETWEEN PersonDetailsPEO.EFFECTIVE_START_DATE AND PersonDetailsPEO.EFFECTIVE_END_DATE) AND ( DATE'2024-04-16'  BETWEEN PersonNamePEO.EFFECTIVE_START_DATE AND PersonNamePEO.EFFECTIVE_END_DATE) AND ( DATE'2024-04-16'  BETWEEN AssignmentPEO.EFFECTIVE_START_DATE AND AssignmentPEO.EFFECTIVE_END_DATE)) AND ( ( (AssignmentPEO.EFFECTIVE_LATEST_CHANGE = 'Y' ) )  AND ((  ( (AssignmentPEO.ASSIGNMENT_TYPE = 'E' ) )  OR ( (AssignmentPEO.ASSIGNMENT_TYPE = 'C' ) )  OR ( (AssignmentPEO.ASSIGNMENT_TYPE = 'N' ) )  OR ( (AssignmentPEO.ASSIGNMENT_TYPE = 'P' ) )  )) )) V486837407, (SELECT /*+ qb_name(CodeCombinationPVO) */ CodeCombination.CODE_COMBINATION_ID FROM GL_CODE_COMBINATIONS CodeCombination) V371846109 WHERE (V156107575.CREDIT_CARD_TRXN_ID = V188742348.CREDIT_CARD_TRXN_ID1(+) AND V156107575.EXPENSE_REPORT_ID = V188742348.EXPENSE_REPORT_ID1(+) AND V156107575.PERSON_ID = V486837407.PERSON_ID271(+) AND V156107575.ASSIGNMENT_ID = V486837407.ASSIGNMENT_ID776(+) AND V486837407.DEFAULT_CODE_COMB_ID = V371846109.CODE_COMBINATION_ID(+)) AND ( ( ( NOT ( (V188742348.EXPENSE_STATUS_CODE = 'APPROVAL_COMPLETE' ) ) )  OR ( (V188742348.EXPENSE_REPORT_NUM IS NULL ) ) )  AND ( NOT ( (V486837407.PERSON_NUMBER IS NULL ) ) )  AND ( ( NOT ( (V188742348.EXPENSE_STATUS_CODE = 'INVOICED' ) ) )  OR ( (V188742348.EXPENSE_REPORT_NUM IS NULL ) ) )  AND ( ( NOT ( (V188742348.EXPENSE_STATUS_CODE = 'INVOICE_CANCELED' ) ) )  OR ( (V188742348.EXPENSE_REPORT_NUM IS NULL ) ) )  AND ( ( NOT ( (V188742348.EXPENSE_STATUS_CODE = 'PAID' ) ) )  OR ( (V188742348.EXPENSE_REPORT_NUM IS NULL ) ) )  AND ( ( NOT ( (V188742348.EXPENSE_STATUS_CODE = 'PARTIAL_PAID' ) ) )  OR ( (V188742348.EXPENSE_REPORT_NUM IS NULL ) ) ) )) T4534805
where  ( ( TRUNC( TO_DATE('2024-04-16' , 'YYYY-MM-DD') ) - TRUNC( T4534805.C351787014 ) ) >= 30 and T4534805.C365682431 is not null ) ),
SAWITH1 AS (select  /*+ inline */  sum(D1.c9) as c1,
     concat(concat(concat(concat(concat(concat(D1.c10, ','), D1.c11), ','), D1.c12), ','), D1.c13) as c2,
     D1.c3 as c3,
     D1.c4 as c4,
     D1.c5 as c5,
     D1.c6 as c6,
     D1.c7 as c7,
     ( TRUNC( TO_DATE('2024-04-16' , 'YYYY-MM-DD') ) - TRUNC( D1.c4 ) ) as c8
from 
     SAWITH0 D1
group by D1.c3, D1.c4, D1.c5, D1.c6, D1.c7, concat(concat(concat(concat(concat(concat(D1.c10, ','), D1.c11), ','), D1.c12), ','), D1.c13), ( TRUNC( TO_DATE('2024-04-16' , 'YYYY-MM-DD') ) - TRUNC( D1.c4 ) ))
select D1.c1 as c1, D1.c2 as c2, D1.c3 as c3, D1.c4 as c4, D1.c5 as c5, D1.c6 as c6, D1.c7 as c7, D1.c8 as c8, D1.c9 as c9 from ( select 0 as c1,
     D1.c2 as c2,
     D1.c3 as c3,
     D1.c4 as c4,
     D1.c5 as c5,
     D1.c6 as c6,
     D1.c7 as c7,
     D1.c8 as c8,
     D1.c1 as c9
from 
     SAWITH1 D1
order by c5, c6, c3, c2, c7, c4, c8 ) D1 where rownum <= 250001

]